#+title: Pentest Evidence
#+AUTHOR: MDB Dev
#+DESCRIPTION: New Pentest Evidence
#+auto_tangle: t
#+STARTUP: showeverything

* TOC :TOC:
:PROPERTIES:
:ID:       42cc6466-2aa7-42b0-9c68-0d1443827117
:END:
- [[#contents-of-scans-folder][Contents Of Scans Folder:]]
- [[#nmap-04][NMAP:]]
- [[#aquatoneeyewitness-scans-web-00][Aquatone/Eyewitness Scans (Web):]]
  - [[#eyewitness-scan-01][Eyewitness Scan:]]
  - [[#aquatone-scan-01][Aquatone Scan:]]
- [[#masscannessus-scans-03][Masscan/Nessus Scans:]]
- [[#ad-enumeration-scans][AD Enumeration Scans:]]

* Contents Of Scans Folder:
:PROPERTIES:
:ID:       cb1bff89-5f9d-4fc5-9d9c-f0665fb33e1a
:END:
#+begin_src shell
tree .
#+end_src


* NMAP [0/4]:
:PROPERTIES:
:ID:       61428dd8-54e2-4788-abd1-d9e483f7b126
:END:


- *Ping Sweep of Network* to generate ~Hosts.txt~:
  - src_bash{for i in {1..254}; do (ping -c 1 172.16.1.$i | grep "bytes from" >> ping_results.txt &) ; done; wait; grep -oE '([0-9]{1,3}\.){3}[0-9]{1,3}' ping_results.txt > hosts.txt; rm ping_results.txt}

- +!!!+ =Run wafw00f before any of these to establish if we need to use evasive scans= +!!!+
  - [ ] wafw00f <domain>


- [ ] *Scan Network Range to get lay of land* [0/3]:
  - [ ] _TCP No Port Scan_ [0/1]:
    - [ ] sudo nmap <ip>/24 -sn -Pn -oA <outputname>
  - [ ] _UDP No Port Scan_ [0/1]:
    - [ ] sudo nmap -sU <ip>/24 -sn -Pn -oA <outputname>
  - [ ] _Includes Ports_ [0/1]:
    - [ ] sudo nmap -sA -Pn <ip/range> -oA networkSweep

- [ ] *Basic Scan* [0/2]: (Scans Top 1000 Ports and does service ananlysis)
  - [ ] _TCP_ [0/2]:
    - [ ] sudo nmap -sV -sC -O --reason -Pn --disable-arp-ping -oA <ip-TCPinitialScan> -iL hosts.txt
    - [ ] for IP in $(cat hosts.txt); do [ ! -d "$IP" ] && mkdir "$IP"; sudo nmap -sV -sC -O --reason -Pn --disable-arp-ping "$IP" -oA "$IP/${IP}-TCPIntialScan"; done
  - [ ] _UDP_ [0/2]:
    - [ ] sudo nmap -sU -sV -O --reason -Pn --disable-arp-ping -oA <ip-UDPinitialScan> -iL hosts.txt
    - [ ] for IP in $(cat hosts.txt); do [ ! -d "$IP" ] && mkdir "$IP"; sudo nmap -sU -sV -O --reason -Pn --disable-arp-ping "$IP" -oA "$IP/${IP}-UDPIntialScan"; done


- [ ] [[Indepth Scans:]] [0/1]:
  - [ ] _TCP_ [0/0]:
    - *10K Ports*:
      - [ ] sudo nmap --top-ports=10000 -sV -sC -O --reason -Pn --disable-arp-ping -oA 10kPortsTCP -iL scopeList
      - [ ] for IP in $(cat hosts.txt); do [ ! -d "$IP" ] && mkdir "$IP"; sudo nmap --top-ports=10000 -sV -sC -O --reason -Pn --disable-arp-ping "$IP" -oA "$IP/${IP}-10KPortsTCP"; done

    - *All Ports*:
      - [ ] sudo nmap -p- -sV -sC -O --reason --disable-arp-ping -oA FullTCP -iL scopeList
      - [ ] for IP in $(cat hosts.txt); do [ ! -d "$IP" ] && mkdir "$IP"; sudo nmap -p- -sV -sC -O -Pn --reason --disable-arp-ping "$IP" -oA "$IP/${IP}-FullTCP"; done




  - [ ] _UDP_ [0/0]:
    - *10K Ports*:
      - [ ] sudo nmap --top-ports=10000 -sU -sV -Pn --disable-arp-ping -oA 10kPortsUDP -iL scopeList
      - [ ] for IP in $(cat hosts.txt); do [ ! -d "$IP" ] && mkdir "$IP"; sudo nmap --top-ports=10000 -sU -sV -A -O --reason -Pn --disable-arp-ping "$IP" -oA "$IP/${IP}-10KPortsUDP"; done

    - *All Ports*:
      - [ ] sudo nmap -p- -sU -A -Pn --disable-arp-ping -oA FullUDP -iL scopeList
      - [ ] for IP in $(cat hosts.txt); do [ ! -d "$IP" ] && mkdir "$IP"; sudo nmap -p- -sU -A -O --reason -Pn --disable-arp-ping "$IP" -oA "$IP/${IP}-FullUDP"; done



* Aquatone/Eyewitness Scans (Web): [0/0]
:PROPERTIES:
:ID:       d0eca721-946e-4198-81a2-f671762cb625
:END:
- Run these off the basis of the common ports scan (ingest):
  - When reviewing the results of the below run [[Indepth Scans:]]
________________________________________________________
** [[id:7655547e-716a-47a5-8aed-03d6b6452797][Eyewitness]] Scan [0/1]:
:PROPERTIES:
:ID:       f38aadea-b809-42e0-9c1a-ad7b4e4ce328
:header-args: :tangle ../../MD/Evidence/Scans/Eyewitness :mkdirp yes :perms
:END:

- [ ] eyewitness --web -x <nmap>.xml -d <directoryNameForResults>

- /Remember to read the entire report!!!/ There are often very important discoveries burried deep in the report!
  - Just because it will show High Value Targets at the start doesn't mean these are our best route!

** [[id:5953d611-4d68-4df5-82e9-20aa32df99f7][Aquatone]] Scan [0/1]:
:PROPERTIES:
:ID:       e75d31b4-ba07-4139-b47f-6311f8260b49
:END:
- [ ]  cat <nmap>.xml | ./aquatone -nmap

* Masscan/Nessus Scans [0/3]:
:PROPERTIES:
:ID:       82a0a996-f6d8-4849-a4d2-21510c5ebf8c
:END:
- Use in non-evassive tests as these are noisy:
- [ ] *Masscan*:
- [ ] *Nessus*:
* AD Enumeration Scans:
:PROPERTIES:
:header-args: :tangle ../../MD/Evidence/Scans/ADEnumeration/AD-Enum.md :mkdirp yes :perms
:ID:       e13034a0-3551-49b0-a7d3-b3afacf87442
:END:
#+begin_src org

#+end_src
