#+title: Pentest Enumeration Checklists
#+AUTHOR: MDB Dev
#+DESCRIPTION: Pentest Enumeration Checklists
#+STARTUP: showeverything

* Publick Checklists:
:PROPERTIES:
:ID:       97fdaab6-05c8-4bb4-9191-60ebfceba110
:END:
 - Pentetsting Methodology:
   - https://book.hacktricks.xyz/generic-methodologies-and-resources/pentesting-methodology
 - Extenernal Recon Methodology:
   - https://book.hacktricks.xyz/generic-methodologies-and-resources/external-recon-methodology
 - Linux Privesc Methodology:
   - https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist
 - Windows Privesc Methodology:
   - https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation
 - Web Vulns Testing Methodology:
   - https://book.hacktricks.xyz/pentesting-web/web-vulnerabilities-methodology

* Initial Enumeration [0/5]:
:PROPERTIES:
:ID:       7a4da731-7cf7-47f3-91d8-8fc76f845304
:END:
- [ ] Nmap Scans in [[file:Scans.org]]
- [ ] dns zone transfer.
- [ ] subdomain enumeration.
  - [ ] ffuf
- [ ] vhost scans.
  - [ ] vhostscan
- [ ] add any found hosts to /etc/hosts

* Web [0/12]:
:PROPERTIES:
:ID:       cbc2f96c-99ea-4b10-9e6b-d6a23a479671
:END:

+PROXY Everything through burp!+

- [ ] Sub-Domain Enumeration.
- [ ] Fuzz parameters.
- [ ] Dir-busting.
  - [ ] Verify status codes match expected page responses.
- [ ] [[id:6f76c142-ddb9-45d4-8dc6-63999f7fed92][Command Injections]]:
- [ ] Cookie Editor.
- [ ] [[id:2f9123a4-a9d7-42ca-a091-4cc2f393f643][XSS]]:
  - [ ] [[id:2f9123a4-a9d7-42ca-a091-4cc2f393f643][Cookie stealing via XSS]]:
- [ ] [[id:bee65fdc-7a23-4128-9dea-7a11e3f787e2][SSRF]]:
  - [ ] [[id:8d25b856-ded6-4d5f-bb49-2184a612fcf5][SSRF to Local file Read]]:
- [ ] [[id:bbf27a0f-f189-426e-9f47-ca03b9d8d314][Verb Tampering]]:
- [ ] [[id:2f8463fd-e438-4db2-ba38-6c863ae8749f][File Upload Exploits]]:
- [ ] [[id:0e18abb4-a42f-4954-833e-a75d2800502d][XML External Entitiy XXE Processing]]
- [ ] Eyewitness on subdomains.
- [ ] Bruteforce using Hydra:
* Intial Network Enumeration:
:PROPERTIES:
:ID:       482e7a06-e306-426e-99b9-65cc7331c374
:END:
- [ ] Start Capturing Traffic with tcpdump
  - tcpdump -i ens192 -s 65535 -w ilfreight_pcap
- [ ] Scan network to get lay of the land:
  - [ ] [[id:f3811bfe-8d48-4458-bea6-835b22c2b390][NMAP]]
  - [ ] Static Binaries
- [ ] SMB
- [ ] NFS
- [ ] [[id:e31f9671-7208-4a9e-a5b7-6fbd2d43b9be][ASREPRoasting:]]
  - [ ] [[id:7199c041-0cf9-4a72-85e0-2d8ae49b2b99][Responder]]
* Windows Privesc Checklist: [0/15]
:PROPERTIES:
:ID:       cfe63111-83f0-47f4-9964-cc967ab0aff3
:END:
- [ ] Literally just work through [[id:daf2629e-4164-4dae-a282-de582d068ade][PrivEsc Windows]]



- [ ] *System Info*: [0/7]
  - [ ] *Tasklist:*
    - tasklist /svc
  - [ ] *Envs:*
    - set
  - [ ] *General Info:*
    - systeminfo
  - [ ] *Patch Status:*
    - wmic qfe
    - Get-HotFix | ft -AutoSize
  - [ ] *Installed Programs:*
    - wmic product get name
    - Get-WmiObject -Class Win32_Product | select Name, Version
  - [ ] *Network:*
    - netstat -ano
  - [ ] *Password Policy:*
    - net accounts


- [ ] *User*: [0/4]
  - [ ] *Logged in users:*
      - query user
  - [ ] *Current user:*
      - echo %USERNAME%
  - [ ] *Current user privileges:*
      - whoami /priv
  - [ ] *Get all users:*
      - net user

- [ ] *Groups*:
  - [ ] *Current User Group Information:*
      - whoami /groups
  - [ ] *Get all groups:*
      - net localgroup
  - [ ] *Details about group:*
      - net localgroup administrators


- [ ] *Logging/AV enumeration*: [0/8]
  - [ ] Check Audit and WEF settings
  - [ ] Check LAPS
  - [ ] Check if WDigest is active
  - [ ] LSA Protection?
  - [ ] Credentials Guard?
  - [ ] Cached Credentials?
  - [ ] Check if any AV
  - [ ] AppLocker Policy?

- [ ] *UAC* [0/3]
  - [ ] _User Privileges_: [0/3]
    - [ ] Check current user privileges
    - [ ] Are you member of any privileged group?
    - [ ] Check if you have any of these tokens enabled: SeImpersonatePrivilege, SeAssignPrimaryPrivilege, SeTcbPrivilege, SeBackupPrivilege, SeRestorePrivilege, SeCreateTokenPrivilege, SeLoadDriverPrivilege, SeTakeOwnershipPrivilege, SeDebugPrivilege ?
  - [ ] _Users Sessions_: [0/2]
    - [ ] Check users homes (access?)
    - [ ] Check Password Policy
  - [ ] What is inside the Clipboard?

- [ ] *Network*: [0/6]
  - [ ] Can we run [[id:80b112f6-8a76-4f45-9a22-bac493e414a3][net-creds]] or [[id:8689ef2d-d9b9-4061-bdfc-2cb14058ec84][wireshark]] to sniff traffic for clear text creds.
  - [ ] Run [[id:7199c041-0cf9-4a72-85e0-2d8ae49b2b99][Responder]]
  - [ ] Check current network information
  - [ ] Check hidden local services restricted to the outside
  - [ ] Enumerate the network (shares, interfaces, routes, neighbours, ...)
  - [ ] Take a special look at network services listening on localhost (127.0.0.1)

- [ ] *Running Processes*: [0/4]
  - [ ] Processes binaries file and folders permissions
  - [ ] Memory Password mining
  - [ ] Insecure GUI apps
  - [ ] Steal credentials with interesting processes via ProcDump.exe ? (firefox, chrome, etc ...)

- [ ] *Services*: [0/4]
  - [ ] Can you modify any service?
  - [ ] Can you modify the binary that is executed by any service?
  - [ ] Can you modify the registry of any service?
  - [ ] Can you take advantage of any unquoted service binary path?

- [ ] *Applications*: [0/3]
  - [ ] Write permissions on installed applications
  - [ ] Startup Applications
  - [ ] Vulnerable Drivers

- [ ] *DLL Hijacking*: [0/4]
  - [ ] Can you write in any folder inside PATH?
  - [ ] Is there any known service binary that tries to load any non-existant DLL?
  - [ ] Can you write in any binaries folder?
  - [ ] [[id:bbc76243-ef3b-4c90-9bea-5baf5cad999c][Docker]]
    - https://medium.com/@morgan.henry.roman/elevation-of-privilege-in-docker-for-windows-2fd8450b478e


+ [ ] *Windows Credentials*: [0/9]
  - [ ] Winlogon credentials
  - [ ] Windows Vault credentials that you could use?
  - [ ] Interesting DPAPI credentials?
  - [ ] Passwords of saved Wifi networks?
  - [ ] Interesting info in saved RDP Connections?
  - [ ] Passwords in recently run commands?
  - [ ] Remote Desktop Credentials Manager passwords?
  - [ ] AppCmd.exe exists? Credentials?
  - [ ] SCClient.exe? DLL Side Loading?

+ [ ] *Files and Registry (Credentials)*: [0/15]
  - [ ] Putty: Creds and SSH host keys
  - [ ] SSH keys in registry?
  - [ ] Passwords in unattended files?
  - [ ] Any SAM & SYSTEM backup?
  - [ ] Cloud credentials?
  - [ ] McAfee SiteList.xml file?
  - [ ] Cached GPP Password?
  - [ ] Password in IIS Web config file?
  - [ ] Interesting info in web logs?
  - [ ] Do you want to ask for credentials to the user?
  - [ ] Interesting files inside the Recycle Bin?
  - [ ] Other registry containing credentials?
  - [ ] Inside Browser data (dbs, history, bookmarks, ...)?
  - [ ] Generic password search in files and registry
  - [ ] Tools to automatically search for passwords

+ [ ] *Leaked Handlers*: [0/1]
  - [ ] Have you access to any handler of a process run by administrator?

+ [ ] *Pipe Client Impersonation*:  [0/1]
  - [ ] Check if you can abuse it

* Linux Privesc Checklist [0/21]:
:PROPERTIES:
:ID:       4224a822-0e42-44aa-a5b7-525e558f86ba
:END:
- *Good cheat sheets*:
  - https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/linux-privilege-escalation/
  - https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist
_______________________________________________________


- [ ] Just go through this -  [[id:aa5277ed-cac0-4a81-8356-aa41b9c05300][PrivEsc Linux]]
- *Easy Wins First*:
  - [ ] sudo -l
  - [ ] [[id:0b04eab4-964d-45b8-b95e-d2f0a76bfd82][suid]] bits

_________________________________
- [ ] *System Information*: [0/11]
  - [ ] Get OS information
  - [ ] Check the PATH, any writable folder?
  - [ ] Check env variables, any sensitive detail?
  - [ ] Check kernel version
  - [ ] Search for [[id:b8180829-418b-4464-b30f-47771bd28042][kernel exploits]] using scripts (DirtyCow?)
    - [ ] Is GCC installed
  - [ ] Check if the sudo version is vulnerable
  - [ ] Dmesg signature verification failed
  - [ ] More system enum (date, system stats, cpu info, printers)
  - [ ] Enumerate more defenses
  - [ ] Is host connected to AD?
    - [ ] If so check [[id:ed939a20-dd6c-48ca-8bdb-0f15659dc83b][How to identify if a linux host is part of an Active Directory domain:]]
  - [ ] Read logs:

- [ ] [[id:217fd8c7-2a08-4124-890b-62772f733d90][Drives]]: [0/3]
  - [ ] List mounted drives
  - [ ] Any unmounted drive that we can mount?
  - [ ] Any creds in fstab?

- [ ] *Installed Software*: [0/3]
  - [ ] _Binaries_ [0/1]:
    - [ ] Check for [[id:0085ac78-6bdb-48a0-814a-d744dc5ce454][Interesting/Custom/Odd Binaries/Package enumeration:]]
  - [ ] _Packages_: [0/1]
    - [ ] Check for [[id:d14bf39a-78a6-48a7-9ab3-66276f535f65][Enumerating Installed Packages & Binaries:]]
  - [ ] _Programming Languages_: [0/1]
    - [ ] Check for [[id:f8ee7745-3f41-45a9-ad3f-5054396e3194][List installed programming languages:]]

- [ ] *Processes*: [0/7]
  - [ ] Is any unknown software running?
  - [ ] Is any software running with more privileges than it should have?
  - [ ] Search for exploits of running processes (especially the version running).
  - [ ] Can you modify the binary of any running process?
  - [ ] Monitor processes and check if any interesting process is running frequently.
  - [ ] Can you read some interesting process memory (where passwords could be saved)?
  - [ ] Run [[id:3d64d333-6bc7-4853-a1e7-51094b478aa4][pspy]]

- [ ] *Scheduled/Cron jobs?*: [0/4]
  - [ ] Is the PATH being modified by some cron and you can write in it?
  - [ ] Any [[id:0492ed2f-735b-46b5-a665-24b206482780][wildcard]] in a cron job?
  - [ ] Some modifiable script is being executed or is inside modifiable folder?
  - [ ] Have you detected that some script could be or are being executed very frequently? (every 1, 2 or 5 minutes)

- [ ] *Services*: [0/3]
  - [ ] Any writable .service file?
  - [ ] Any writable binary executed by a service?
  - [ ] Any writable folder in systemd PATH?

- [ ] *Timers*: [0/1]
  - [ ] Any writable timer?

- [ ] *Sockets*: [0/3]
  - [ ] Any writable .socket file?
  - [ ] Can you communicate with any socket?
  - [ ] HTTP sockets with interesting info?

- [ ] *D-Bus*: [0/1]
  - [ ] Can you communicate with any D-Bus?

- [ ] *Network*: [0/5]
  - [ ] Enumerate the network to know where you are
  - [ ] Open ports you couldn't access before getting a shell inside the machine?
  - [ ] Can you sniff traffic using tcpdump?
  - [ ] Anything interesting in the /etc/hosts file?
  - [ ] Are there any interesting network connections to other systems in the internal network or even outside the network?

- [ ] *Users*: [0/6]
  - [ ] [[id:55c6c3be-2b50-4193-bf29-dc2a2f3610f9][Enumerate Users:]]
  - [ ] [[id:3dcc7deb-9812-476b-867b-50662e3c2124][Enumerate Groups:]]
  - [ ] Do you have a very big UID? Is the machine vulnerable?
  - [ ] Can you escalate privileges thanks to a group you belong to?
  - [ ] Clipboard data?
  - [ ] Enumerate logged in users (lastlog)

- *Password Policy* [0/1]
  - [ ] Try to use every known password that you have discovered previously to login with each possible user. Try to login also without a password.

- [ ] *Writable PATH* [0/1]
  - [ ] If you have write privileges over some folder in [[id:b0898224-a4fd-43e8-b814-267032bd922a][PATH]] you may be able to escalate privileges

- [ ] *SUDO and SUID commands*: [0/11]
  - [ ] Can you execute any command with sudo? Can you use it to READ, WRITE or EXECUTE anything as root? (GTFOBins)
  - [ ] Is any exploitable [[id:0b04eab4-964d-45b8-b95e-d2f0a76bfd82][SUID binary]]? (GTFOBins)
  - [ ] Are sudo commands limited by path? can you bypass the restrictions?
  - [ ] Sudo/SUID binary without path indicated?
  - [ ] SUID binary specifying path? Bypass
  - [ ] [[id:a3b87dfd-7848-406e-bdf3-9df8c1303639][LD_PRELOAD]] vuln
  - [ ] Lack of .so library in SUID binary from a writable folder?
  - [ ] SUDO tokens available? Can you create a SUDO token?
  - [ ] Can you read or modify sudoers files?
  - [ ] Can you modify /etc/ld.so.conf.d/?
  - [ ] OpenBSD DOAS command

- [ ] *Capabilities*: [0/1]
  - [ ] Has any binary any unexpected [[id:cc7da672-2ad3-4bc4-b8fd-251f36b534c8][capabilities]].

- [ ] *ACLs*: [0/1]
  - [ ] Has any file any unexpected ACL?

- [ ] *Open Shell sessions*: [0/2]
  - [ ] [[id:f12291cf-4249-4b72-98fc-c56bc5c0f853][screen]]
  - [ ] [[id:82c91768-c980-461b-9009-dd3bd1f8ef2d][tmux]]

- [ ] *SSH*: [0/2]
  - [ ] Debian OpenSSL Predictable PRNG - CVE-2008-0166
  - [ ] SSH Interesting configuration values

- [ ] *Interesting Files*: [0/17]
  - [ ] Bash history
  - [ ] [[id:e477ed2e-9b03-446b-be5e-fc19b9042ded][Locate Passwords, SSH Keys & Txt files:]]
  - [ ] [[id:21951906-81cb-43da-b352-859df3202b4d][System Sensitive files]]
  - [ ] [[id:eac47812-2050-4e08-a42b-9ed8d59e61c9][Enumerate log files:]]
  - [ ] Profile files - Read sensitive data? Write to privesc?
  - [ ] passwd/shadow files - Read sensitive data? Write to privesc?
  - [ ] Check commonly interesting folders for sensitive data
  - [ ] Weird Location/Owned files, you may have access to or alter executable files
  - [ ] Modified in last mins
  - [ ] Sqlite DB files
  - [ ] [[id:9e3d3777-2499-45ae-a024-07630b452bd8][Hidden files]]
  - [ ] Script/Binaries in PATH
  - [ ] Web files (passwords?)
  - [ ] [[id:d03e9e36-3907-4f09-8f09-098b512ec808][.bak]] files
  - [ ] Backups?
  - [ ] Known files that contains passwords: Use [[id:6e6e5b55-2ee8-4f64-8dbd-870de5458a74][Linpeas]] and LaZagne
  - [ ] Generic search

- [ ] *Writable Files*: [0/4]
  - [ ] Modify [[id:75e229de-1ec5-43ad-a493-623fcf93f414][python library]] to execute arbitrary commands?
  - [ ] Can you modify log files? [[id:041e5762-b603-426c-a548-dff373e9a204][Logrotten]] exploit
  - [ ] Can you modify /etc/sysconfig/network-scripts/? Centos/Redhat exploit
  - [ ] Can you write in ini, int.d, systemd or rc.d files?

- [ ] *Other tricks*: [0/2]
  - [ ] Can you abuse [[id:b44330be-01b2-46cc-9bd8-af4f230cbb63][NFS]] to escalate privileges?
  - [ ] Do you need to escape from a [[id:cb45bc7d-c93d-4452-85d3-a63d33b75ff2][restrictive shell]]?

- [ ] [[id:f64025ff-2f27-411b-b8e8-5d62c2426059][Container Abuse/Privesc:]]

___________________________________________
* Active Directory Enumeration:
:PROPERTIES:
:ID:       7af9599a-f75e-4f90-b3dd-1db06e3f340a
:END:
- [[id:81519ec8-e26b-4b49-a2a9-d63e91602719][Active Directory Enumeration]]
